%Vaibhav Bisht
%MS, Mechanical Engineering, Cornell University

clc
clear all

%A, B, C & D for state-space model

A = [0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 1.195, 0, 9.73, 0, 0, 0;
     0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, -0.9925, 0, 1.195, 0, 0, 0;
     0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;
     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

 B = [0, 0, 0, 0;
      0, 0, 0, 0;
      0, 0, 0, 0;
      0, 0, 0, 0;
      0, 0, 0, 0;
      20/13, 0, 0, 0;
      0, 0, 0, 0;
      0, 400/3, 0, 0;
      0, 0, 0, 0;
      0, 0, 400/3, 0;
      0, 0, 0, 0;
      0, 0, 0, 1000/13];

 C = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
      0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
      0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;
      0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;
      0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;
      0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
      0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0;
      0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;
      0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;
      0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1];
  
D = [0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0;
     0, 0, 0, 0];
  
 %Parameters for white noise part of state-space form 
  q = 1e-3;
  Ts = 0.01;
  r = 1e-4;
  
 %Covariance matrix of Process Noise
  Q = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0.12, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1];
  
  %Covariance matrix of Measurement Noise
  R = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0.22, 0, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 1.51, 0, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.01];